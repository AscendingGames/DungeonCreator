sudo: required
language: android
jdk: oraclejdk8
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -rf $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches"
  - "$HOME/.gradle/wrapper/"
  - "$HOME/.android/build-cache"
android:
  components:
  - tools
  - tools
  - platform-tools
  - build-tools-28.0.2
  - android-28
before_install:
- openssl aes-256-cbc -K $encrypted_8c3bfc17a2d7_key -iv $encrypted_8c3bfc17a2d7_iv
  -in keystore.jks.enc -out keystore.jks -d
- openssl aes-256-cbc -K $encrypted_8c3bfc17a2d7_key -iv $encrypted_8c3bfc17a2d7_iv
  -in android.jks.enc -out android.jks -d
- yes | sdkmanager "platforms;android-28"
- chmod +x gradlew
script:
- "./gradlew clean test build"
after_success:
- bash <(curl -s https://codecov.io/bash)
deploy:
  provider: releases
  api_key:
    secure: p+dbCE9zCUpkUEQGdMKnrQraKQVT/Iy4UnWUinI/cZU3ehkB/yIYvxteS38v3IGNZ3tA1z/4a/BfGJ/EJME0SOkKXfaF6ZpoQRHl/gH+1uLRNY2XUDpFWvLE4KOHp6byF21j3Mq/c7h656/q4TxL/++E1TVXPCSDVONrGphcK2bcmGikhkGm58KQkci95ioyeSTgE8dTWw1KSKBsJBXQQ90m92ZA+rFFFA2uHQ/4n8iGKajpVyFPqi+QFDUEPXp4/QyXSQQAXFt7w+w7Huqr2fkQcTNZqhBMzly1kQafHM/EEACpV2rNWqnO41dNkYR1WVGpItpVhhqCJSJ5OSYVr0C/UMJ4WgapnTFjxtOXy9Rm14/mBY6VjxJ/PMAvTbmdw3g9RqTYF5Yj8rs2gff4862vU8n0+iS9CIewlfBmokYu48x9bPUZMP12EqqLFJuWtrmsIkrsF7dHmOy2ktKxi4JytloYnpALJmja7GwRczY4Jp0LjgIYpz5qv0QOs+7uMVa35gXNjwLVDt69lCzII4tbZI4ejjiQqKFeXaxD3O/pfwwxOot2cnRK4gRkEft+L6zj77Ht1rF6bUKFPKT4j7bIvImZDO+8uesbdSm9f+RY7ew1p/1NF1Eo4K03o/XmI3miSTs/ds05bqBuBzeyKU2v9rQD+L0hqIRE52BKZqM=
  file: android/release/android-release.apk
  on:
    repo: AscendingGames/DungeonCreator
    branch: development
